# Table of Contents #

# Introduction #

DOM Xss Test Cases Wiki Project

# Details #

## Sources ##

### How to read tables ###
Tables contents describe output given some input.
Headers are:

  * **source**: Javascript object name
  * **browser**: Browser Name
  * **version**: Browser version tested
  * **pathInfo**: characters that are not urlencoded in the pathInfo part
  * **Search**: characters that are not urlencoded in the search part
  * **Hash**:  characters that are not urlencoded in the hash part
  * **output sample**: A sample of the output given by getting the property, if needed.

Sometimes you'll find something like `[`A-B`]`, that means that it has to be considered the whole interval of ascii characters from A to B.

The missing characters in the table elements are to be considered urlencoded, if described otherwise and excluding **/`[`a-z0-9`]`/i**

Finally, some interesting characters are bold.

### The location/documentURI/URL Sources ###

Considering the classic url format:

**scheme://user:pass@host/path/to/page.ext/**<font color='red'>Pathinfo;semicolon</font><font color='green'>?search.location=value</font><font color='blue'>#hash=value&hash2=value2</font>

and given a sample url:

**http://host/path/to/page.ext/**<font color='red'>test<a"'%0A<code>`</code>= +%20>;test<a"'%0A<code>`</code>= +%20></font><font color='green'>?test<a"'%0A<code>`</code>= +%20>;</font><font color='blue'>#test<a"'%0A<code>`</code>= +%20>;**</font>**

the following table shows how direct call of
  * document.URL
  * document.documentURI
  * document.URLUnencoded (IE 5.5 or later Only)
  * document.baseURI
  * location
  * location.href
  * location.search
  * location.hash
  * location.pathname

are natively treated:


| **Source** | **browser** | **version** | **pathInfo** | **Search** | **Hash** | **output sample**|
|:-----------|:------------|:------------|:-------------|:-----------|:---------|:-----------------|
| document.URL |   IE 8     |  8       | 33 (`!`), 36 (`$`), 38 (`&`), 39 (`'`), 40 (`(`), 41 (`)`), 42 (`*`), 43 (`+`), 44 (`,`), 45 (`-`), 46 (`.`), 47 (`/`), 58 (`:`), 59 (`;`), 61 (`=`), 64 (`@`), 91 (`[`), 93 (`]`), 95 (`_`), 126 (`~`), `[`128-255`]` | 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (` `), 33 (`!`), 34 (`"`), 36 (`$`), 38 (`&`), 39 (`'`), 40 (`(`), 41 (`)`), 42 (`*`), 43 (`+`), 44 (`,`), 45 (`-`), 46 (`.`), 47 (`/`), 58 (`:`), 59 (`;`), 60 (`<`), 61 (`=`), 62 (`>`), 63 (`?`), 64 (`@`), 91 (`[`), 92 (`\`), 93 (`]`), 94 (`^`), 95 (`_`), 96 (`````), 123 (`{`), 124 (`|`), 125 (`}`), 126 (`~`), `[`127-255`]`  | 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (` `), 33 (`!`), 34 (`"`), 35 (`#`), 36 (`$`), 38 (`&`), 39 (`'`), 40 (`(`), 41 (`)`), 42 (`*`), 43 (`+`), 44 (`,`), 45 (`-`), 46 (`.`), 47 (`/`), 58 (`:`), 59 (`;`), 60 (`<`), 61 (`=`), 62 (`>`), 63 (`?`), 64 (`@`), 91 (`[`), 92 (`\`), 93 (`]`), 94 (`^`), 95 (`_`), 96 (`````), 123 (`{`), 124 (`|`), 125 (`}`), 126 (`~`), `[`127 - 255`]`  |  http://host/path/to/page.ext/<font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test<a"'%0A<code>`</code>=%20+%20>;<font color='blue'>#test<a"'%0A<code>`</code>=%20+%20>;</font>
<tr><td> document.URL </td><td>    Firefox     </td><td>  3.6.8     </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E;test%3Ca%22%27%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;<font color='blue'>#test%3Ca%22%27%0A%60=%20+%20%3E;</font>    </td></tr>
<tr><td> document.URL </td><td>   Chrome     </td><td>   6.0.472.53 beta     </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>) </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td> <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A<code>`</code>=%20+%20%3E;<font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>     </td></tr>
<tr><td> document.URL </td><td>    Opera     </td><td>  10.61     </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td> <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A<code>`</code>=%20+%20%3E;test%3Ca%22'%0A<code>`</code>=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;<font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>    </td></tr>
<tr><td> document.documentURI </td><td>   IE 8     </td><td>  8       </td><td>  undefined  </td><td> undefined </td><td>undefined  </td><td>  undefined     </td></tr>
<tr><td> document.documentURI </td><td>    Firefox     </td><td>  3.6.8        </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td>  33 (<code>!</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td>   <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E;test%3Ca%22%27%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;<font color='blue'>#test%3Ca%22%27%0A%60=%20+%20%3E;</font>     </td></tr>
<tr><td> document.documentURI </td><td>    Chrome     </td><td>   6.0.472.53 beta  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>),  <code>[</code>127 - 255<code>]</code> </td><td>    <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A<code>`</code>=%20+%20%3E;<font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>     </td></tr>
<tr><td> document.documentURI </td><td>    Opera     </td><td>  10.61        </td><td> 255, 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> <b>No Hash</b> </td><td>    <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A<code>`</code>=%20+%20%3E;test%3Ca%22'%0A<code>`</code>=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;</font>     </td></tr>
<tr><td> document.URLUnencoded </td><td>   IE 8     </td><td>  8       </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>), <code>[</code>128 - 255<code>]</code>  </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td>   <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test<a"'%0A<code>`</code>=%20+%20>;<font color='blue'>#test<a"'%0A<code>`</code>=%20+%20>;</font>  </td></tr>
<tr><td> document.URLUnencoded </td><td>   Firefox     </td><td>  3.6.8         </td><td>  undefined </td><td> undefined  </td><td> undefined </td><td> undefined    </td></tr>
<tr><td> document.URLUnencoded </td><td>     Chrome     </td><td>   6.0.472.53 beta     </td><td>  undefined </td><td>  undefined </td><td> undefined </td><td>  undefined    </td></tr>
<tr><td> document.URLUnencoded </td><td>   Opera     </td><td>  10.61         </td><td> undefined  </td><td> undefined  </td><td> undefined  </td><td> undefined    </td></tr>
<tr><td> document.baseURI </td><td>   IE 8     </td><td>  8       </td><td> undefined  </td><td> undefined </td><td> undefined </td><td>    undefined     </td></tr>
<tr><td> document.baseURI </td><td>     Firefox     </td><td>  3.6.8         </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td>    <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E;test%3Ca%22%27%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;<font color='blue'>#test%3Ca%22%27%0A%60=%20+%20%3E;</font>    </td></tr>
<tr><td> document.baseURI </td><td>      Chrome     </td><td>   6.0.472.53 beta       </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>) </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td>    <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A<code>`</code>=%20+%20%3E;<font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>   </td></tr>
<tr><td> document.baseURI </td><td>     Opera     </td><td>  10.61         </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> <b>No Hash</b> </td><td>    <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A<code>`</code>=%20+%20%3E;test%3Ca%22'%0A<code>`</code>=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;</font>    </td></tr>
<tr><td> location </td><td>   IE 8     </td><td>  8       </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>), <code>[</code>128 - 255<code>]</code>    </td><td>  1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 -  255<code>]</code> </td><td>  1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td>  <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test<a"'%0A<code>`</code>=%20+%20>;</font><font color='blue'>#test<a"'%0A<code>`</code>=%20+%20>;</font>     </td></tr>
<tr><td> location </td><td>   Firefox     </td><td>  3.6.8      </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 33 (<code>!</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td>    <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E;test%3Ca%22%27%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;</font><font color='blue'>#test%3Ca%22%27%0A%60=%20+%20%3E;</font>    </td></tr>
<tr><td> location </td><td>   Chrome     </td><td>   6.0.472.53 beta     </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>)   </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 -  255<code>]</code>  </td><td>   <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A<code>`</code>=%20+%20%3E;</font><font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>    </td></tr>
<tr><td> location </td><td>   Opera     </td><td>  10.61       </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)   </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td>   <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;</font><font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>    </td></tr>
<tr><td> location.href </td><td>   IE 8     </td><td>  8       </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>), <code>[</code>128 - 255<code>]</code>   </td><td>  1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 -  255<code>]</code> </td><td>  <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test<a"'%0A<code>`</code>=%20+%20><font color='blue'>;#test<a"'%0A<code>`</code>=%20+%20>;</font>   </td></tr>
<tr><td> location.href </td><td>     Firefox     </td><td>  3.6.8       </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>)  </td><td>  33 (<code>!</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td><a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E;test%3Ca%22%27%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;<font color='blue'>#test%3Ca%22%27%0A%60=%20+%20%3E;</font>   </td></tr>
<tr><td> location.href </td><td>     Chrome     </td><td>   6.0.472.53 beta  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>) </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 -  255<code>]</code>  </td><td>  <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A<code>`</code>=%20+%20%3E;<font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>   </td></tr>
<tr><td> location.href </td><td>     Opera     </td><td>  10.61       </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td> <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;<font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>    </td></tr>
<tr><td> location.pathname </td><td>   IE 8     </td><td>  8       </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>), <code>[</code>128 - 255<code>]</code>     </td><td> <b>No Search</b> </td><td> <b>No Hash</b> </td><td>  /path/to/page.ext/<font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font> </td></tr>
<tr><td> location.pathname </td><td>    Firefox     </td><td>  3.6.8        </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 61 (<code>=</code>), 64 (<code>@</code>), 95 (<code>_</code>), 124 (<code>|</code>), 126 (<code>~</code>) </td><td> <b>No Search</b> </td><td> <b>No Hash</b> </td><td> /path/to/page.ext/<font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E</font> </td></tr>
<tr><td> location.pathname </td><td>    Chrome     </td><td>   6.0.472.53 beta     </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>) </td><td> <b>No Search</b> </td><td> <b>No Hash</b> </td><td> /path/to/page.ext/<font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font> </td></tr>
<tr><td> location.pathname </td><td>    Opera     </td><td>  10.61        </td><td> 27, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127-255<code>]</code>  </td><td> <b>No Search</b> </td><td> <b>No Hash</b> </td><td> /path/to/page.ext/<font color='red'>test<a"'%0A<code>`</code>= + >;test<a"'%0A<code>`</code>= + ></font> </td></tr>
<tr><td> location.search </td><td>   IE 8     </td><td>  8       </td><td> <b>No pathName</b> </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127-255<code>]</code></td><td> <b>No Hash</b> </td><td>  <font color='green'>?test<a"'%0A<code>`</code>=%20+%20>;</font>    </td></tr>
<tr><td> location.search </td><td>    Firefox     </td><td>  3.6.8        </td><td> <b>No pathName</b>  </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> <b>No Hash</b> </td><td>  <font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;</font>   </td></tr>
<tr><td> location.search </td><td>      Chrome     </td><td>   6.0.472.53 beta        </td><td> <b>No pathName</b>     </td><td>  33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> <b>No Hash</b> </td><td> <font color='green'>?test%3Ca%22'%0A<code>`</code>=%20+%20%3E;</font>  </td></tr>
<tr><td> location.search </td><td>    Opera     </td><td>  10.61        </td><td>  <b>No pathName</b> </td><td> 33 (<code>!</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> <b>No Hash</b> </td><td> <font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;</font>    </td></tr>
<tr><td> location.hash </td><td>   IE 8     </td><td>  8       </td><td>  <b>No pathName</b>   </td><td> <b>No Search</b> </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td><font color='blue'>#test<a"'%0A<code>`</code>=%20+%20>;</font>   </td></tr>
<tr><td> location.hash </td><td>     Firefox     </td><td>  3.6.8       </td><td> <b>No pathName</b>  </td><td> <b>No Search</b> </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>128 - 255<code>]</code>  </td><td><font color='blue'>#test<a"'%0A<code>`</code>= + >;</font>  </td></tr>
<tr><td> location.hash </td><td>     Chrome     </td><td>   6.0.472.53 beta    </td><td> <b>No pathName</b>   </td><td> <b>No Search</b> </td><td> 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255 <code>]</code></td><td><font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>  </td></tr>
<tr><td> location.hash </td><td>     Opera     </td><td>  10.61       </td><td> <b>No pathName</b>  </td><td> <b>No Search</b> </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 35 (<code>#</code>), 36 (<code>$</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td>  <font color='blue'>#test<a"'%0A<code>`</code>= +%20>;</font>   </td></tr></tbody></table>

(To Be Finished with Safari tests)<br>
<br>
<h3>The Cookies Sources</h3>

Characters in Cookie values are invariant to the way they have been given.<br>
Which means that if a JavaScript application sets:<br>
<pre><code><br>
document.cookie="PREF=a\x01b; expires=Sun, 09-Sep-2012 06:38:09 GMT; path=/; domain=.host.tld"<br>
</code></pre>

the resulting cookie will be:<br>
<pre><code>"PREF=ab;"<br>
//for browsers that don't show the whole string, "a\x01b" <br>
</code></pre>

For what concerns setting cookie precedence from two different hostnames sharing the same subdomain Kuza55 gives a very good compound <a href='#References.md'>[4</a>] about browsers behavior.<br>
<br>
In particular quoted:<br>
<pre><code> Resolving Conflicts<br>
<br>
 But what if two cookies of the same name should be sent to a given page, e.g. <br>
 if there is a cookie called "user" set for mail.google.com and .google.com with <br>
 different values, how does the browser decide which one to send?<br>
 <br>
 RFC 2109 states that the cookie with the more specific path attribute must be <br>
 sent first, however it does not define how to deal with two cookies which have <br>
 the same path (e.g. /) but different domains. If such a conflict occurs then <br>
 most (all?) browsers simply send the older cookie first.<br>
 <br>
 This means that if we want to overwrite a cookie on mail.google.com from the<br>
 subdomain news.google.com, and the cookie already exists, then we cannot over-write<br>
 a cookie with the path value of / (or whatever the path value of the existing<br>
 cookie is), but we can override it for every other path (up to the maximum number<br>
 of cookies allowed per host; 50 in IE/Firefox 30 in Opera), i.e. if we pick 50<br>
 (or 30 if we want to target opera) paths on mail.google.com which encompass the<br>
 directories and pages we want to overwrite the cookie for, we can simply set<br>
 50 /30 separate cookies which are all more specific than the existing cookie.<br>
</code></pre>


Also Kuza55 talks about paths:<br>
<pre><code>Technically the spec say that a.b.c.d cannot set a cookie for a.b.c.d or b.c.d <br>
only, none of the browsers enforce this since it breaks sites. <br>
Also, sites should not be able to set a cookie with a path attribute which would<br>
 not apply to the current page, but since path <br>
boundaries are non-existant in browsers, no-one enforces this restriction either.<br>
</code></pre>

From a Javascript cookie string perspective, multiple cookies with same name are<br>
returned.<br>
<br>
Which means that given two hosts with same domain:<br>
<pre><code>Time t - From: vi.ct.im/path/to/page/<br>
document.cookie="SESSION=TRUESESSION; path=/";<br>
<br>
Time t+1 - From: v2.ct.im/another/path/to/a/page/<br>
document.cookie="SESSION=FAKESESSION; path=/path/to/page; domain=.ct.im"<br>
<br>
Time t+2 - From: vi.ct.im/path/to/page/<br>
document.cookie<br>
returns <br>
"SESSION=FAKESESSION; SESSION=TRUESESSION;"<br>
</code></pre>

Usually getCookie functions from javaScript get the first occurrence of the cookie name, so, in this very case, the FAKESESSION value will be returned.<br>
<pre><code>getCookie = function (name) {<br>
  var search = name + '=';<br>
  var returnValue = '';<br>
<br>
  if (document.cookie.length &gt; 0) {<br>
    offset = document.cookie.indexOf(search);<br>
    if (offset != -1) {<br>
      offset += search.length;<br>
      var end = document.cookie.indexOf(';', offset);<br>
      if (end == -1) {<br>
        end = document.cookie.length;<br>
      }<br>
      returnValue = decodeURIComponent(document.cookie.substring(offset, end).replace(/\+/g, '%20'));<br>
    }<br>
  }<br>
<br>
  return returnValue;<br>
};<br>
</code></pre>
Of course if the function returns the last occurrence of the name in cookie string, the attacker will force a very generic cookie from vi2.ct.im:<br>
<pre><code>  From: v2.ct.im/another/path/to/a/page/<br>
document.cookie="SESSION=FAKESESSION; path=/; domain=.ct.im"<br>
</code></pre>

This can be considered a case of Parameter Pollution in Cookies <a href='#References.md'>[5</a>].<br>
<br>
Depending on how the JavaScript application will later use specific cookie values, this manipulation can be used to inject attacker controlled inputs and use them not only for Session Fixation but also to control JavaScript flow or to perform classic DOMXss.<br>
<br>
<br>
<br>
<h3>The Referrer Source</h3>
The following table shows how direct call of<br>
<br>
<ul><li>document.referrer</li></ul>

are natively treated:<br>
<br>
<table><thead><th> <b>Source</b> </th><th> <b>browser</b> </th><th> <b>version</b> </th><th>  <b>pathInfo</b> </th><th> <b>Search</b> </th><th> <b>Hash</b> </th><th> <b>output sample</b></th></thead><tbody>
<tr><td> document.referrer </td><td>     IE 8     </td><td>  8        </td><td> 33 (<code>!</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>), <code>[</code>128 - 255<code>]</code> </td><td> 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32 (<code> </code>), 33 (<code>!</code>), 34 (<code>"</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 60 (<code>&lt;</code>), 61 (<code>=</code>), 62 (<code>&gt;</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code> </td><td> none </td><td> <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22%27%0A%60=%20+%20%3E;test%3Ca%22%27%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22%27%0A%60=%20+%20%3E;</font>    </td></tr>
<tr><td> document.referrer </td><td>     Firefox    </td><td>  3.6.8      </td><td> 33 (<code>!</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> 33 (<code>!</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> None  </td><td>   <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test<a"'%0A<code>`</code>=%20+%20>;</font>    </td></tr>
<tr><td> document.referrer </td><td>       Chrome     </td><td>   6.0.472.53 beta        </td><td> 33 (<code>!</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 95 (<code>_</code>), 126 (<code>~</code>)  </td><td>  33 (<code>!</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 92 (<code>\</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> None </td><td> <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A%60=%20+%20%3E;test%3Ca%22'%0A%60=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A`=%20+%20%3E;</font>    </td></tr>
<tr><td> document.referrer </td><td>       Opera     </td><td>  10.61    </td><td> 33 (<code>!</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 96 (<code>`</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>), <code>[</code>127 - 255<code>]</code>  </td><td> 33 (<code>!</code>), 37 (<code>%</code>), 38 (<code>&amp;</code>), 39 (<code>'</code>), 40 (<code>(</code>), 41 (<code>)</code>), 42 (<code>*</code>), 43 (<code>+</code>), 44 (<code>,</code>), 45 (<code>-</code>), 46 (<code>.</code>), 47 (<code>/</code>), 58 (<code>:</code>), 59 (<code>;</code>), 61 (<code>=</code>), 63 (<code>?</code>), 64 (<code>@</code>), 91 (<code>[</code>), 93 (<code>]</code>), 94 (<code>^</code>), 95 (<code>_</code>), 123 (<code>{</code>), 124 (<code>|</code>), 125 (<code>}</code>), 126 (<code>~</code>) </td><td> None    </td><td>   <a href='http://host/path/to/page.ext/'>http://host/path/to/page.ext/</a><font color='red'>test%3Ca%22'%0A<code>`</code>=%20+%20%3E;test%3Ca%22'%0A`=%20+%20%3E</font><font color='green'>?test%3Ca%22'%0A%60=%20+%20%3E;</font>    </td></tr></tbody></table>

(To Be Finished with Safari tests)<br>
<br>
<h3>The Window Name Source</h3>

Characters in window.name value are invariant to the way they have been given.<br>
Which means that if a JavaScript application sets:<br>
<br>
<pre><code>window.name='a\x01b'<br>
</code></pre>

no encoding is applied.<br>
<br>
Window.name attribute is always a cast to the string representation of the object it is assigned to.<br>
<br>
The window.name attribute is a persistent value during the existence of the page to which is assigned.<br>
<br>
An attacker can set new windows names and frames with no restriction, and they will persist during navigation on any domain.<br>
<br>
<h3>Indirect Sources</h3>

(TBA)<br>
<br>
<h4>Storage Object</h4>

HTML 5 Storage objects <a href='#References.md'>[6</a>]<a href='#References.md'>[7</a>]<a href='#References.md'>[8</a> ] can be considered an indirect source, since they can be used to store values from direct sources and use them later insecurely.<br>
<br>
Indirect source objects are:<br>
<br>
<ul><li>localStorage<br>
</li><li>sessionStorage<br>
</li><li>Database (Safari Only)</li></ul>

<h4>Server Response Sources</h4>

Previously server side stored data could be used by an attacker to send untrusted input<br>
to Javascript.<br>
<br>
(TBF)<br>
<br>
<h3>Other Objects Sources</h3>

(TBA)<br>
<br>
<ul><li>opener (IE <= 7 Only)<br>
</li><li>parent/top/frames<code>[</code>i<code>]</code>.obj<br>
</li><li>event.data of onmessage event for postMessage method</li></ul>

<h4>Opener</h4>

In 2008 in <a href='#References.md'>[[3</a>]] it was presented a study about Browser Based DOM Xss, describing how browsers behave when objects belonging to different windows and domains are overwritten or deleted from evil pages.<br>
<br>
It was found that IE <= 7 allows cross windows/cross domain opener redefinition, causing the re-instantiation of the object in the other window thus breaking the SOP in access control.<br>
<br>
<pre><code>// From attacker.tld<br>
window.aFrame.location="http://victim/PageUsingOpenerObject.html"<br>
window.aFrame.opener={someAttr:"someValue", someAttr2: function(){return someReturnValue}}<br>
</code></pre>

So if a page from victim host uses:<br>
<pre><code>&lt;script&gt;<br>
document.writeln("&lt;p&gt;" + window.opener.Message + "&lt;/p&gt;");<br>
&lt;/script&gt;<br>
</code></pre>

An attacker can use from <code>&lt;iframe name=aFrame&gt;&lt;/iframe&gt;</code>
<pre><code>// From attacker.tld<br>
window.aFrame.location="http://victim/PageUsingOpenerObject.html"<br>
window.aFrame.opener={Message:"&lt;sc"+"ript&gt;alert(document.domain)&lt;/scr"+"ipt&gt;"}<br>
</code></pre>

The code above works perfectly on IE7 and the fake Message is taken by victim host, without any error message.<br>
<br>
Opener object can, hence, be considered as a source of untrusted input in the unfortunate case the victim uses IE 7.<br>
<br>
N.B. IE 8 fixes this issue.<br>
<br>
<h2>Sinks</h2>
(TBA)<br>
<h3>Execution Sinks</h3>
(TBA)<br>
<h3>Set Object Sinks</h3>
(TBA)<br>
<h3>HTMLElement Sinks</h3>
(TBA)<br>
<h3>Style Sinks</h3>
(TBA)<br>
<h3>XMLHttpRequest Sink</h3>
(TBA)<br>
<h3>Set Cookie Sink</h3>
(TBA)<br>
<h3>Set Location Sink</h3>
(TBA)<br>
<h3>Control Flow Sink</h3>
(TBA)<br>
<h3>Use of Equality And Strict Equality</h3>
(TBA)<br>
<h3>Math.random Sink</h3>
(TBA)<br>
<h3>JSON Sink</h3>
(TBA)<br>
<h3>XML Sink</h3>
(TBA)<br>
<br>
<h1>Glossary</h1>

<b>Source:</b>
an input that could be controlled by an external (untrusted) source.<br>
<br>
<b>Sink:</b>
a sink is a potentially dangerous method that could lead to a vulnerability.<br>
In this case a DOM Based Xss.<br>
<br>
<h1>References</h1>
<code>[</code>1<code>]</code> <a href='http://www.webappsec.org/projects/articles/071105.shtml'>"DOM Based Cross Site Scripting or XSS of the Third Kind"</a>, A. Klein, 2005.<br>
<br>
<code>[</code>2<code>]</code> <a href='http://blog.watchfire.com/wfblog/2008/06/javascript-code.html'>"JavaScript Code Flow Manipulation, and a real world example advisory - Adobe Flex 3 Dom-Based XSS"</a>, O. Segal & A. Sharabani, A. Yogev, June 2008.<br>
<br>
<code>[</code>3<code>]</code> <a href='http://www.ruxcon.org.au/files/2008/Attacking_Rich_Internet_Applications.pdf'>Attacking_Rich_Internet_Applications</a>, S. Di Paola & A. Kuza, 2008.<br>
<br>
<code>[</code>4<code>]</code> <a href='http://kuza55.blogspot.com/2008/02/understanding-cookie-security.html'>Understanding Cookie Security</a> , A. Kuza, February 22, 2008.<br>
<br>
<code>[</code>5<code>]</code> <a href='http://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf'>Http Parameter Pollution</a> , L. Carettoni S. Di Paola, 2009.<br>
<br>
<code>[</code>6<code>]</code> <a href='http://dev.w3.org/html5/webdatabase/'>W3C ClientSide Database</a>

<code>[</code>7<code>]</code> <a href='http://dev.w3.org/html5/webstorage'>W3C Web Storage</a>

<code>[</code>8<code>]</code> <a href='http://msdn.microsoft.com/en-us/library/cc197062%28VS.85%29.aspx'>Microsoft's Introduction to DOM Storage</a>